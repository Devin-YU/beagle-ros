From 1ccfc10c0afec7c6fd73804e1ac48cc46fd31eb0 Mon Sep 17 00:00:00 2001
From: victor <v.mayoralv@gmail.com>
Date: Mon, 1 Jul 2013 14:46:42 +0200
Subject: [PATCH] apr use a AC_TRY_RUN to check if PTHREAD_MUTEX_RECURSIVE is supported and this don't work on cross compile.

By default apr_cv_mutex_recursive in apr is set to no and this leads to the APRENOTIMPL return value of apr_thread_mutex_create in thread_mutex.c when APR_THREAD_MUTEX_NESTED is requ    ested via flags. Added EXTRA_OECONF += "apr_cv_mutex_recursive=yes" to sources/openembedded-core/meta/recipes-support/apr/apr_1.4.6.bb.

Signed-off-by: VÃ­ctor Mayoral Vilches <v.mayoralv@gmail.com>
---
 meta/recipes-support/apr/apr_1.4.6.bb |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/meta/recipes-support/apr/apr_1.4.6.bb b/meta/recipes-support/apr/apr_1.4.6.bb
index 896f79f..9200dcc 100644
--- a/meta/recipes-support/apr/apr_1.4.6.bb
+++ b/meta/recipes-support/apr/apr_1.4.6.bb
@@ -23,6 +23,9 @@ inherit autotools lib_package binconfig multilib_header
 
 OE_BINCONFIG_EXTRA_MANGLE = " -e 's:location=source:location=installed:'"
 
+# Added to fix rosnode issues. Refer to https://github.com/bmwcarit/meta-ros/issues/68#issuecomment-19896928
+EXTRA_OECONF += "apr_cv_mutex_recursive=yes"
+
 do_configure_prepend() {
 	cd ${S}
 	./buildconf
-- 
1.7.9.5

